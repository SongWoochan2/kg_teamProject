<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="moviephotoMapper">
	
	<insert id="moviePhotoInsert" parameterType="moviePhotoDTO">
		insert into movie_photo values(movie_photo_seq.nextval, #{movie_code},#{movie_photo_name},#{movie_photo_addr}, sysdate)
	</insert>

	<delete id="moviePhotoDelete" parameterType="int">
		delete from movie_photo where movie_photo_code = #{movie_photo_code}
	</delete>
	
	
	
	<select id = "moviePhotoList" parameterType="java.util.Map" resultType="moviePhotoDTO">
		<![CDATA[select movie_photo_code, movie_photo_name, movie_photo_addr,
				to_char(upload_date, 'YYYY.MM.DD') as upload_date from 
				(select rownum rn, tt.* from 
				(select * from movie_photo order by movie_photo_code desc) tt where movie_code=#{movie_code} ) 
				 where rn>=#{startNum} and rn<=#{endNum}]]>
	</select>
	
	<select id = "moviePhotoView" parameterType="int" resultType="moviePhotoDTO">
		select movie_photo_name, movie_photo_addr,
				to_char(upload_date, 'YYYY.MM.DD') as upload_date from movie_photo
				where movie_photo_code = #{movie_photo_code}
	</select>
	
	<select id = "getTotal" parameterType= "int" resultType="int">
		select count(*) from movie_photo where movie_code = #{movie_code}
	</select>
	
	<select id = "moviePosterView" parameterType= "int" resultType="moviePhotoDTO">
		select * from movie_photo where movie_code = #{movie_code} and movie_photo_addr like 'poster_' || '%'
	</select>
</mapper>
